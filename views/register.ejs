<%- include("partials/header"); -%>
<form action="">
    <h2>signUp</h2>
    <label for="username">username</label>
    <input type="text" name="username" required>
    <div style="color: red;" class="username error"></div>

    <label for="password">password</label>
    <input type="password" name="password" required>
    <div style="color: red;" class="password error"></div>

    <button>signUp</button>
</form>

<script>
    const form = document.querySelector("form");
    const usernameError = document.querySelector('.username.error');
    const passwordError = document.querySelector('.password.error');
    form.addEventListener('submit', async (e) => {
        e.preventDefault();



        const username = form.username.value
        const password = form.password.value

        try{
            const res = await fetch("/register", {
                method: "POST",
                body: JSON.stringify({username, password}),
                headers:{'Content-Type': 'application/json'}

            })
            const data = await res.json()
            console.log(data)
            if(data.errors){
                usernameError.textContent = data.errors.username
                passwordError.textContent = data.errors.password
            }
            if(data.user){
                location.assign("/")
            }
    } catch (err){
        console.log(err)

    }


        
    })
</script>


<%- include("partials/footer"); -%>